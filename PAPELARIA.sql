CREATE USER PAPELARIA IDENTIFIED BY PAPELARIA;
GRANT CONNECT, RESOURCE TO PAPELARIA;
CONNECT PAPELARIA/PAPELARIA;

DROP TABLE FORNECIMENTO;
DROP TABLE COMPRA;
DROP TABLE FONE_PAPELARIA;
DROP TABLE CONTATO_FORNEC;
DROP TABLE PES_FISICA;
DROP TABLE PES_JURIDICA;
DROP TABLE FORNECEDOR;
DROP TABLE PRODUTO;
DROP TABLE CLIENTE;
DROP TABLE PAPELARIA;


CREATE TABLE CLIENTE (
CODCLI NUMBER(4),
NOMECLI VARCHAR2(60),
ENDERCLI VARCHAR2(100),
STATUS VARCHAR2(20),
CONSTRAINT PK_CLIENTE PRIMARY KEY (CODCLI));

CREATE TABLE PES_FISICA (
CODCLI NUMBER(4),
CPF NUMBER(20),
RG CHAR(20),
CONSTRAINT UK_FISICA UNIQUE (CODCLI),
CONSTRAINT FK_FISICA FOREIGN KEY (CODCLI)
REFERENCES CLIENTE (CODCLI)); 

ALTER TABLE PES_FISICA ADD CONSTRAINT
UK_FIS_CPF UNIQUE (CPF);

CREATE TABLE PES_JURIDICA (
CODCLI NUMBER(4),
CNPJ NUMBER(20),
IE NUMBER(20),
CONSTRAINT UK_JURIDICA UNIQUE (CODCLI),
CONSTRAINT FK_JURIDICA FOREIGN KEY (CODCLI)
REFERENCES CLIENTE (CODCLI)); 

ALTER TABLE PES_JURIDICA ADD CONSTRAINT
UK_JUR_CNPJ UNIQUE (CNPJ);

CREATE TABLE FORNECEDOR (
CNPJ NUMBER(20),
IE NUMBER(20),
RAZAO VARCHAR2(80),
ENDERECO VARCHAR2(100),
TELEFONE NUMBER(20),
CONSTRAINT PK_FORNECEDOR PRIMARY KEY (CNPJ));

CREATE TABLE CONTATO_FORNEC (
CNPJ NUMBER(20),
NOME VARCHAR2(40),
FONEFIXO NUMBER(20),
CELULAR NUMBER(20),
CONSTRAINT PK_CONTATO PRIMARY KEY (CNPJ, NOME),
CONSTRAINT FK_CONT_CNPJ FOREIGN KEY (CNPJ) REFERENCES FORNECEDOR (CNPJ));


CREATE TABLE PRODUTO (
CODPROD NUMBER(4),
DESCRICAO VARCHAR(40),
QUANTIDADE NUMBER(10),
PRECO NUMBER(6,2),
CONSTRAINT PK_PRODUTO PRIMARY KEY (CODPROD));

CREATE TABLE PAPELARIA (
CNPJ NUMBER(20),
RAZAO VARCHAR(40),
FANTASIA VARCHAR(40),
ENDERECO VARCHAR2(100),
GERENTE VARCHAR(40),
CONSTRAINT PK_PAPELARIA PRIMARY KEY (CNPJ));

CREATE TABLE FONE_PAPELARIA (
CNPJ NUMBER(20),
NUMERO NUMBER(20),
CONSTRAINT PK_FONE_PAP PRIMARY KEY (CNPJ, NUMERO),
CONSTRAINT FK_FONE_PAP FOREIGN KEY (CNPJ) REFERENCES PAPELARIA (CNPJ));


CREATE TABLE FORNECIMENTO (
CNPJ_PAP NUMBER(20),
CNPJ_FORNEC NUMBER(20),
CODPROD NUMBER(4),
DATA DATE,
VALOR NUMBER(10,2),
QUANTIDADE NUMBER(10),
CONSTRAINT PK_FORNECIMENTO PRIMARY KEY (CNPJ_PAP, CNPJ_FORNEC,
CODPROD, DATA),
CONSTRAINT FK_FORN_PAP FOREIGN KEY (CNPJ_PAP) REFERENCES
PAPELARIA (CNPJ),
CONSTRAINT FK_FORN_FOR FOREIGN KEY (CNPJ_FORNEC) REFERENCES
FORNECEDOR (CNPJ));


ALTER TABLE FORNECIMENTO ADD CONSTRAINT 
FK_FORN_PROD FOREIGN KEY (CODPROD) REFERENCES PRODUTO (CODPROD);


CREATE TABLE COMPRA (
CNPJ NUMBER(20),
CODPROD NUMBER(4),
CODCLI NUMBER(4),
DATA DATE,
HORA DATE,
CONSTRAINT PK_COMPRA PRIMARY KEY (CNPJ,CODPROD, CODCLI, DATA, HORA),
CONSTRAINT FK_COMPRA_PAP FOREIGN KEY (CNPJ) REFERENCES PAPELARIA (CNPJ),
CONSTRAINT FK_COMPRA_PROD FOREIGN KEY (CODPROD) REFERENCES PRODUTO (CODPROD),
CONSTRAINT FK_COMPRA_CLI FOREIGN KEY (CODCLI) REFERENCES CLIENTE (CODCLI));

alter table compra add quantidade number(10);
alter table compra add valor number(10,2);

INSERT INTO CLIENTE VALUES (1, 'MARIA', 'RUA DAS ACACIAS - 600 - CHAPECO - SC','RUIM');
INSERT INTO CLIENTE VALUES (2, 'SADIA', 'AV. SENADOR ATILIO FONTANA - 500 - CHAPECO - SC','ÓTIMO');
INSERT INTO CLIENTE VALUES (3, 'AURORA', 'AV. SÃO PEDRO - 500 - CHAPECO - SC','BOM');
INSERT INTO PES_FISICA VALUES (1, 99988877765, '12R900800');
INSERT INTO PES_JURIDICA VALUES (2, 80070090000012, 8888888);
INSERT INTO FORNECEDOR VALUES (22233344400012, 9999999, 'RAZAO TESTE', 'AV. GETULIO VARGAS - 500 - CHAPECO -SC', 3224455);
INSERT INTO CONTATO_FORNEC VALUES (22233344400012, 'JOAO DA SILVA', 3218900, 99972535);
INSERT INTO PRODUTO VALUES (1, 'CANETA AZUL BIC', 10000, 0.15);
INSERT INTO PRODUTO VALUES (2, 'CANETA PRETA BIC', 10000, 0.12);
INSERT INTO PRODUTO VALUES (3, 'CANETA VERMELHA BIC', 10000, 0.31);
INSERT INTO PRODUTO VALUES (4, 'CADERNO 50 FOLHAS', 2300, 0.31);
INSERT INTO PRODUTO VALUES (5, 'BORRACHA', 4500, 0.39);
INSERT INTO PRODUTO VALUES (6, 'RÉGUA', 1780, 0.65);
INSERT INTO PAPELARIA VALUES (55544466600219, 'PAPELARIA MATRIZ', 'MATRIZ', 'RUA FERNANDO MACHADO - 322 - CHAPECO - SC', 'JOSE PEREIRA');
INSERT INTO FONE_PAPELARIA VALUES (55544466600219, 3224590);
INSERT INTO FONE_PAPELARIA VALUES (55544466600219, 3239090);
INSERT INTO FORNECIMENTO VALUES (55544466600219, 22233344400012, 1, SYSDATE, 190, 200);
INSERT INTO FORNECIMENTO VALUES (55544466600219, 22233344400012, 2, SYSDATE, 190, 300);
INSERT INTO COMPRA VALUES (55544466600219, 2, 1, SYSDATE, TO_DATE('08:00:22', 'HH24:MI:SS'), 1000,12);
INSERT INTO COMPRA VALUES (55544466600219, 1, 1, SYSDATE, TO_DATE('08:00:22', 'HH24:MI:SS'), 1000,15);
INSERT INTO COMPRA VALUES (55544466600219, 2, 2, SYSDATE, TO_DATE('08:00:22', 'HH24:MI:SS'), 1000,31);
INSERT INTO FORNECEDOR VALUES (11133355500017, 6666666,'ATACADO DE MATERIAL ESCOLAR LTDA.','AV. FERNANDO MACHADO - 500 - CHAPECO - SC',3224556);

commit;
